<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>06 Hooks | Essential React</title>

    <link rel="icon" href="../img/zuehlke_logo.jpg" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/webplatformz/zuehlke-reveal-package@aa0782bae9e270f4153d310e9f42bea172788e21/release/index.css"
    />
  </head>

  <body>
    <div class="reveal">
      <div class="slides">
        <section class="deck-slide">
          <h1>
            Essential React <br />
            06 Hooks
          </h1>
        </section>
        <section>
          <p>Let's build a real app!</p>
          <img src="../img/state_management_part_1_goal.png" />

          <p>How can this be achieved?</p>
        </section>
        <section>
          <section>
            <h2>How to handle component-level state</h2>
          </section>
          <section>
            <h3>The <span class="warn">useState</span> Hook</h3>
            <pre><code class="hljs tsx" data-trim data-line-numbers="1,4"><script type="text/template">
                import { useState } from "react";

                function MyComponent() {
                  const [name, setName] = useState("");
                }
            </script></code></pre>
          </section>
          <section>
            <pre><code class="hljs tsx" data-trim><script type="text/template">
              function MyComponent() {
                // Define a name state with the initial value of ""
                const [name, setName] = useState("");
            
                // The setName function updates the state
                setName("Joe");

                // The variable 'name' contains the current state value
                return <p>Name: {name}</p>
              }
            </script></code></pre>
          </section>
          <section>
            <pre>
                <code class="hljs tsx" data-trim><script type="text/template">
                  const [name, setName] = useState("");
                  
                  const [age, setAge] = useState(0);
                  
                  const [meal, setMeal] = useState<Meal>();
                </script></code>
            </pre>
            <p>
              The array destructuring makes it easy to use multiple states in a
              component.
            </p>
          </section>
        </section>
        <section>
          <section><h2>How to handle input</h2></section>
          <section data-auto-animate>
            <p>
              The <span class="warn">onChange</span> prop is a function which is
              called when the input is changed.
            </p>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="|3-5"><script type="text/template">
  <input
    type="text"
    onChange={(event) => {
      /* Do something */
    }}
  />
  </script></code></pre>
          </section>
          <section data-auto-animate>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="3-5"><script type="text/template">
  <input
    type="text"
    onChange={(event) => {
      console.log(event.target.value);
    }}
  />
  </script></code></pre>

            <p>
              Use <span class="warn">event.target.value</span> to access the
              value which was entered.
            </p>
          </section>
        </section>
        <section>
          <h2>Exercise</h2>

          <p><img src="../img/state_management_part_1_goal.png" /></p>
          <ol>
            <li>Allow the user to enter their name</li>
            <li>
              The entered name is displayed as a greeting next to the input
              field
            </li>
            <li>
              Display the input field on top of the list - routing will come
              later
            </li>
          </ol>
        </section>
        <section>
          <h2>Solution</h2>
          <pre><code class="hljs tsx" data-trim data-line-numbers="|4,11-14"><script type="text/template">
import { useState } from "react";

function Profile() {
  const [username, setUsername] = useState("");

  return (<>
    <label htmlFor="username">Username</label>
    <input
      type="text"
      id="username"
      value={username}
      onChange={(e) => {
        setUsername(e.target.value);
      }}
    />
  </>);
}</script></code></pre>
        </section>
        <section>
          <section>
            <h3>What are Hooks?</h3>
            <p>
              Hooks are functions that let you "hook into" React state and
              lifecycle features.
            </p>
          </section>
          <section>
            <h3>Built-in Hooks</h3>
            <ul>
              <li>useState</li>
              <li>useEffect</li>
              <li>useContext</li>
              <li>useReducer</li>
              <li>use&hellip;</li>
            </ul>
          </section>
          <section>
            <h3>How to use Hooks</h3>
            <pre><code class="hljs tsx" data-trim data-line-numbers="5"><script type="text/template">
import { useState } from "react";

function MyComponent() {

  const [color, setColor] = useState("blue");

  // …
}
</script></code></pre>
            <p>The Hook function is called in the render function.</p>
            <p>
              Depending on the Hook, it may have parameters and may provide a
              return value to access the provided functionality.
            </p>
          </section>
          <section>
            <h3>Rules of Hooks</h3>
            <ul>
              <li>
                Only call Hooks at the <span class="warn">top level</span> (not
                inside loops, conditions, or nested functions)
              </li>
              <li>
                Only call Hooks from
                <span class="warn">React function components</span> or
                <span class="warn">custom Hooks</span>
              </li>
            </ul>
            <p>
              The <span class="code">eslint-plugin-react-hooks</span> enforces
              these rules.
            </p>
          </section>
          <section>
            <h2>History of Hooks</h2>

            <p>
              Before Hooks were introduced in 2019, features like state
              management required the use of <em>class components</em>.
            </p>

            <p>
              With Hooks these features can be used in function components and
              thereby makes the code <span class="warn">simpler</span> and
              <span class="warn">better reusable</span>.
            </p>
          </section>
        </section>
        <section>
          <section>
            <h2>SyntheticEvent</h2>
          </section>
          <section>
            <pre><code class="hljs tsx" data-trim data-line-numbers="3"><script type="text/template">
  <input
    type="text"
    onChange={(event) => { /* often just called 'e' */
      console.log(event.target.value);
    }}
  />
  </script></code></pre>
            <p>
              Event handlers like <span class="code">onChange</span> receive an
              instance of <span class="code">SyntheticEvent</span>.
            </p>

            <p class="fragment">
              This is a <span class="warn">wrapper for the native events</span>,
              ensuring a consistent API and functionality across browsers.
            </p>
          </section>
          <section>
            <h3>SyntheticEvent API</h3>

            <ul>
              <li><span class="code">e.target.value</span></li>
              <li><span class="code">e.preventDefault()</span></li>
              <li><span class="code">e.nativeEvent</span></li>
              <li>
                API for specific event type (e.g.
                <span class="code">e.keyCode</span>)
              </li>
            </ul>
          </section>
          <section>
            <p>
              <a
                href="https://reactjs.org/docs/events.html"
                target="_blank"
                rel="noopener noreferrer"
              >
                SyntheticEvent API
              </a>
            </p>
          </section>
        </section>

        <section>
          <section><h2>Custom Hooks</h2></section>
          <section>
            <p>
              We can reuse a concrete Hook logic by extracting it into a
              <span class="warn">custom Hook</span>.
            </p>
          </section>
          <section data-auto-animate>
            <p><span class="code">MyComponent.tsx</span></p>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="2"><script type="text/template">
              
              export const fetcher = async <T>(uri: string): Promise<T> => {
                const response = await fetch(uri);

                return response.json();
              };

              function MyComponent() {
                const { data: user } = useQuery(['user'], () => fetcher('/user'))
                
                return <p>{user?.name}</p>;
              }
          </script></code></pre>
          </section>
          <section data-auto-animate>
            <p>&rarr; <span class="code">useUser.ts</span></p>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="3-8"><script type="text/template">
              import { useQuery } from 'react-query';

              export default function useUser() {
                const { data: user, isLoading } = useQuery(['user'], '/user')
                const fullName = `${user?.firstName} ${user?lastName}`

                return {user, isLoading, fullName};
              }
          </script></code></pre>
          </section>

          <section data-auto-animate>
            <p data-id="2"><span class="code">MyComponent.tsx</span></p>

            <pre
              data-id="code2"
            ><code class="hljs tsx" data-trim data-line-numbers="4"><script type="text/template">
              import useUser from "./useUser.ts";

              export default function MyComponent() {
                const {user, isLoading} = useUser();

                /* … */
              }
            
          </script></code></pre>
          </section>
        </section>
        <section>
          <h2>Exercise</h2>

          <p>Extract the debounce logic for the search into a custom Hook.</p>

          <div class="column-container">
            <div class="column">
              <img src="../img/construction_work_refactor.jpg" />
            </div>
          </div>
        </section>
        <section>
          <section>
            <h2>Solution</h2>
          </section>
          <section>
            <p><span class="code">usePokeList.ts</span></p>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="3|12"><script type="text/template">
              import { useEffect, useState } from "react";

              function useDebouncedSearch(initialSearchTerm: string) {
                const [searchTerm, setSearchTerm] = useState(initialSearchTerm);
                const [debouncedSearchTerm, setDebouncedSearchTerm] = useState("");
              
                useEffect(() => {
                  var timoutId = setTimeout(() => setDebouncedSearchTerm(searchTerm), 300);
                  return () => clearTimeout(timoutId);
                }, [searchTerm]);
              
                return { searchTerm, setSearchTerm, debouncedSearchTerm };
              }
              
              export default useDebouncedSearch;
              
</script></code></pre>
          </section>
          <section>
            <p><span class="code">List.tsx</span></p>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="7,8"><script type="text/template">
              import usePokeList from "../../service/poke/usePokeList";
              import PokeListEntry from "./poke-list-entry/PokeListEntry";
              import SearchPanel from "./search-panel/SearchPanel";
              import useDebouncedSearch from "./useDebouncedSearch";
              
              function ListPage() {
                const { searchTerm, setSearchTerm, debouncedSearchTerm } =
                  useDebouncedSearch("");
              
                const pokemons = usePokeList();
                /* ... */
                );
              }
              
              export default ListPage;
              
    
</script></code></pre>
          </section>
        </section>

        <section>
          <h2>Recap</h2>

          <p>We learned&hellip;</p>

          <ul>
            <li>
              How to handle component-level state with
              <span class="warn">useState</span>
            </li>
            <li>How to handle input</li>
            <li>What Hooks are and how to use them</li>
            <li>
              That events are wrapped by
              <span class="code">SyntheticEvent</span>
            </li>
          </ul>
        </section>
        <section class="deck-slide">
          <h1>Questions?</h1>
        </section>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/webplatformz/zuehlke-reveal-package@aa0782bae9e270f4153d310e9f42bea172788e21/release/index.js"></script>
    <script>
      setupZuehlkeRevealPresentation();
    </script>
  </body>
</html>
