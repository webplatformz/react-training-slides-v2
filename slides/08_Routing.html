<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>Routing | Essential React</title>

    <link rel="icon" href="../img/zuehlke_logo.jpg" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/Zuehlke/zuehlke-reveal-package@f42658c99dec0812d754d935263a70b93b81f54b/release/index.css"
    />
  </head>

  <body>
    <div class="reveal">
      <div class="slides">
        <section class="title-slide">
          <h1>Routing</h1>
          <h2>Essential React</h2>
        </section>
        <section>
          <section>
            <p>So far our Pokedex app only has a single page.</p>
          </section>
          <section data-auto-animate>
            <p>Let's make this more interesting&hellip;</p>
            <div class="fragment column-container">
              <div class="column">
                <img src="../img/routing_home.png" />
              </div>
            </div>
          </section>
          <section data-auto-animate>
            <p>Let's make this more interesting&hellip;</p>
            <div class="column-container">
              <div class="column">
                <img src="../img/routing_detail.png" />
              </div>
            </div>
          </section>
          <section>
            <h3>Routing</h3>
            <p class="fragment">
              We want to define distinct pages within our application.
            </p>

            <p class="fragment">
              The current page at a given time is defined by the URL of the
              browser tab.
            </p>

            <p class="fragment">
              The URL can contain parameters which are used by a page to show
              specific data.
            </p>
          </section>
          <section>
            <p>
              React does
              <em>not</em>
              provide routing.
            </p>

            <div class="fragment">
              <p>
                The most popular routing library in the React ecosystem is
                <span class="hl">React Router.</span>
              </p>

              <p>
                <a href="https://reactrouter.com">https://reactrouter.com</a>
              </p>
            </div>
          </section>
        </section>
        <section>
          <section>
            <h2>Basic Routing with React Router</h2>
          </section>
          <section>
            <h3>Install the Package</h3>
            <pre
              data-id="code"
            ><code class="hljs zsh" data-trim><script type="text/template">
          npm install react-router-dom
        </script></code></pre>
          </section>
          <section data-auto-animate>
            <h3>How to Define Routes</h3>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers=""><script type="text/template">
              function App() {
                return (
                  /* Let's route! */
                );
              }
            </script></code></pre>
          </section>
          <section data-auto-animate>
            <h3>How to Define Routes</h3>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="1-2,6-8"><script type="text/template">
              import { BrowserRouter as Router }
                from "react-router-dom";

              function App() {
                return (
                  <Router>

                  </Router>
                );
              }
            </script></code></pre>
            <p>
              The
              <span class="code">BrowserRouter</span>
              provides the access to the routing functionality.
            </p>
          </section>
          <section data-auto-animate>
            <h3>How to Define Routes</h3>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="1-2,6-10"><script type="text/template">
              import { BrowserRouter as Router, Routes }
                from "react-router-dom";

              function App() {
                return (
                  <Router>
                    <Routes>

                    </Routes>
                  </Router>
                );
              }
            </script></code></pre>

            <p>
              A
              <span class="code">Routes</span>
              component renders the most specific matching route (exclusively).
            </p>
          </section>
          <section data-auto-animate>
            <h3>How to Define Routes</h3>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="1-2,6-10"><script type="text/template">
              import { BrowserRouter as Router, Routes, Route }
                from "react-router-dom";

              function App() {
                return (
                  <Router>
                    <Routes>
                      <Route path="/page1" />
                    </Routes>
                  </Router>
                );
              }
            </script></code></pre>

            <p>
              Here we define a route with the path
              <span class="code">/page1</span>
              .
            </p>
          </section>
          <section data-auto-animate>
            <h3>How to Define Routes</h3>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="3,9"><script type="text/template">
              import { BrowserRouter as Router, Routes, Route }
                from "react-router-dom";
              import Page1 from "./Page1.tsx";

              function App() {
                return (
                  <Router>
                    <Routes>
                      <Route path="/page1" element={<Page1 />} />
                    </Routes>
                  </Router>
                );
              }
            </script></code></pre>

            <p>
              The page to be renderered for this route is simply defined as
              <span class="code">element</span>
              of
              <span class="code">Route</span>
              .
            </p>
          </section>
          <section data-auto-animate>
            <h3>How to Define Routes</h3>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="4,11"><script type="text/template">
              import { BrowserRouter as Router, Routes, Route }
                from "react-router-dom";
              import Page1 from "./Page1.tsx";
              import Page2 from "./Page2.tsx";

              function App() {
                return (
                  <Router>
                    <Routes>
                      <Route path="/page1" element={<Page1 />} />
                      <Route path="/page2" element={<Page2 />} />
                    </Routes>
                  </Router>
                );
              }
            </script></code></pre>
          </section>
          <section>
            <p><span class="code">Page1.tsx</span></p>

            <pre><code class="hljs tsx" data-trim data-line-numbers=""><script type="text/template">
              export  function Page1() {
                return <p>This is page 1.</p>;
              }
            </script></code></pre>

            <p>The "page" is just a normal React component.</p>
          </section>
          <section data-auto-animate>
            <h3>Routes with Parameters</h3>

            <pre><code class="hljs tsx" data-trim data-line-numbers="7|"><script type="text/template">
              function App() {
                return (
                  <Router>
                    <Routes>
                      /* … */
                      <Route
                        path="/cars/:carId"
                        element={<CarDetailPage />}
                      />
                    </Routes>
                  </Router>
                );
              }
            </script></code></pre>

            <p>
              This route has a parameter
              <span class="code">carId</span>
              .
            </p>
          </section>
          <section data-auto-animate>
            <h3>Routes with Parameters</h3>

            <p><span class="code">CarDetailPage.tsx</span></p>

            <pre><code class="hljs tsx" data-trim data-line-numbers="|1,4"><script type="text/template">
              import { useParams } from "react-router-dom";

              export  function CarDetailPage() {
                const { carId } = useParams<"carId">();
                return <p>This is the car with the ID {carId}.</p>;
              }
            </script></code></pre>

            <p class="fragment">
              The
              <span class="code">useParams</span>
              Hook returns the parameters of the current route as an object.
            </p>
          </section>
          <section>
            <h3>Route Redirection</h3>

            <pre><code class="hljs tsx" data-trim data-line-numbers="1,7-10"><script type="text/template">
              import { Route, Navigate } from "react-router-dom";

              function App() {
                return (
                  <Router>
                    <Routes>
                      <Route
                        path="/"
                        element={<Navigate to="/page1" replace />}
                      />
                      <Route path="/page1" element={<Page1 />} />
                    </Routes>
                  </Router>
                );
              }
            </script></code></pre>

            <p>
              With the
              <span class="code">Navigate</span>
              component, a route can be redirected to another route.
            </p>
          </section>
          <section>
            <h3>How to Link to a Route</h3>

            <pre><code class="hljs tsx" data-trim data-line-numbers="1,6-7|"><script type="text/template">
              import { Link } from "react-router-dom";

              function NavBar() {
                return (
                  <p>
                    <Link to="/page1">Page 1</Link>
                    | <Link to="/page2">Page 2</Link>
                  </p>
                );
              }
            </script></code></pre>
          </section>
          <section>
            <h3>Cheat Sheet</h3>

            <p><span class="code">&lt;BrowserRouter /&gt;</span></p>
            <p><span class="code">&lt;Routes /&gt;</span></p>
            <p>
              <span class="code"
                >&lt;Route path="/cars/:carId" element={&lt;CarDetailPage /&gt;}
                /&gt;</span
              >
            </p>
            <p>
              <span class="code">&lt;Navigate to="/cars" replace /&gt;</span>
            </p>
            <p>
              <span class="code"
                >&lt;Link to="/cars/42"&gt;Go to Car 42&lt;/Link&gt;</span
              >
            </p>
          </section>
        </section>
        <section>
          <section>
            <h2>Exercise</h2>
            <ol>
              <li>
                Implement a detail view to show the detail data of a specific
                pokemon.
                <p>
                  <span class="code">
                    GET https://pokeapi.co/api/v2/pokemon/${name}
                  </span>
                </p>
              </li>
              <li>
                Split the app up into two navigatable pages:
                <ul>
                  <li>
                    The
                    <em>Home</em>
                    page shows the list of pokemon.
                  </li>
                  <li>
                    When clicking on a pokemon in the list, the pokemon detail
                    page is shown.
                  </li>
                </ul>
              </li>
            </ol>
          </section>
          <section>
            <div class="column-container">
              <div class="column-2">
                <img src="../img/routing_home.png" />
              </div>
              <div class="column-2">
                <img src="../img/routing_detail.png" />
              </div>
            </div>
          </section>
          <section>
            <h2>Detail API</h2>
            <a
              href="https://pokeapi.co/api/v2/pokemon/bulbasaur"
              target="_blank"
              rel="noopener noreferrer"
            >
              https://pokeapi.co/api/v2/pokemon/bulbasaur
            </a>
            <pre>
                <code class="hljs json" data-trim data-noescape>
                    {
                        "name": "bulbasaur",
                        sprites: {
                            "front_shiny": "https://raw.githubusercontent.com/PokeAPI/sprites/master/sprites/pokemon/shiny/1.png",
                            ...
                        },
                        ...
                    }
                </code>
            </pre>
          </section>
          <section>
            <h3>Stretch Goal</h3>
            <p>
              Think about what to do with the username input and display
              functionality.
            </p>

            <p>
              Can we have the input on a
              <em>Profile</em>
              page but show the name on all pages?
            </p>
          </section>
        </section>
        <section>
          <section>
            <h2>Solution</h2>

            <p><span class="code">App.tsx</span></p>

            <pre><code class="hljs tsx" data-trim data-line-numbers="|6,12|7,11|9,10|8|"><script type="text/template">
import { BrowserRouter as Router, Routes, Route, Navigate } from "react-router-dom";
import List from "./pages/list/List";
import DetailPage from "./pages/detail/DetailPage";

export  function App() {
  return (<Router>
    <Routes>
      <Route path="/" element={<Navigate to="/pokemon" replace />} />
      <Route path="/pokemon" element={<ListPage />} />
      <Route path="/pokemon/:name" element={<DetailPage />} />
    </Routes>
  </Router>);
}

            </script></code></pre>
          </section>
          <section>
            <p><span class="code">PokeListEntry.tsx</span></p>

            <pre><code class="hljs tsx" data-trim data-line-numbers="|7|"><script type="text/template">
import { Link } from "react-router-dom";

interface PokeListEntryProps { name: string; }

function PokeListEntry({ name }: PokeListEntryProps) {
  return (<div className="uppercase">
    <Link to={`/pokemon/${name}`}>{name}</Link>
  </div>);
}

export  PokeListEntry;
            </script></code></pre>
          </section>
          <section>
            <p><span class="code">DetailPage.tsx</span></p>

            <pre><code class="hljs tsx" data-trim data-line-numbers="|7|8-9|11-18|"><script type="text/template">
import { useParams } from "react-router-dom";

export  function DetailPage() {
  const { name } = useParams<"name">();
  const { data, isLoading, isError } = useQuery(['pokemon', name], () =>
    fetcher<PokemonDetailDto>(`https://pokeapi.co/api/v2/pokemon/${name}`)
  );
  if (!data) return null;
  return (<>
    <h1>{data.name}</h1>
    <dl>
      <dt>hp</dt>
      <dd>{data.hp}</dd>
      // …
    </dl>
  </>);
}           
            </script></code></pre>
          </section>
        </section>
        <section>
          <section>
            <h2>More about React Router</h2>
          </section>
          <section>
            <h3>NavLink</h3>

            <pre><code class="hljs tsx" data-trim data-line-numbers="4-10"><script type="text/template">
function MyComponent() {
  return (<>
    // …
    <NavLink 
      to="/faq"
      className={({ isActive }) =>
        isActive ? "activated" : ""}
    >
      FAQs
    </NavLink>
  </>);
}
            </script></code></pre>

            <p>
              A
              <span class="code">NavLink</span>
              is marked with the specified CSS class/style when its route is
              active.
            </p>
          </section>
          <section data-auto-animate>
            <h3>Nested Routes</h3>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="5,13|6,7|7,12|8,10"><script type="text/template">
function MyComponent() {
  return (<>
    // …
    <Routes>
      <Route path="/" element={<Layout />}>
        <Route path="boats" element={<BoatPage />} />
        <Route path="cars" element={<CarLayout />}>
          <Route index
                 element={<CarListPage />} />
          <Route path=":carId"
                 element={<CarDetailPage />} />
        </Route>
      </Route>
    </Routes>
  </>);
}
            </script></code></pre>
            <p></p>
          </section>
          <section data-auto-animate>
            <h3>Nested Routes</h3>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="1,6"><script type="text/template">
function Layout() {
  return (<div>

    {/* Navbar… */}

    <Outlet />

  </div>);
}
            </script></code></pre>
            <p></p>
          </section>
          <section>
            <h3>useLocation</h3>

            <p>
              Current URL:
              <span class="code">/cars?filter=Tesla</span>
            </p>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="2,4-8"><script type="text/template">
function MyComponent() {
  const { pathname, search } = useLocation();

  console.log(`Pathname: ${pathname}`);
  /* Pathname: /cars */

  console.log(`Query string: ${search}`);
  /* Query string: ?filter=Tesla */
  
  /* … */
}
            </script></code></pre>

            <p>
              Returns the
              <span class="hl">location</span>
              object representing the current URL.
            </p>
          </section>
          <section>
            <h3>useNavigate</h3>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="2,8"><script type="text/template">
function MyComponent() {
  const navigate = useNavigate();

  return <button onClick={() => {

    // Do something

    navigate('/home');
  }}>
    Do something and then go to Home
  </button>
}
            </script></code></pre>

            <p>Navigate programmatically</p>
          </section>
          <section>
            <h3>MemoryRouter</h3>

            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers=""><script type="text/template">
function MyComponent() {
  return <MemoryRouter
    initialEntries={['/one', '/two', '/three']}
    initialIndex={1}
  >
    // …
  </MemoryRouter>;
}
            </script></code></pre>

            <p>
              Use instead of
              <span class="code">BrowserRouter</span>
              for tests.
            </p>
          </section>
        </section>
        <section>
          <h2>Recap</h2>
          <p>We learned&hellip;</p>
          <ul>
            <li>How to define routes</li>
            <li>How to define routes with parameters</li>
            <li>How to redirect routes</li>
            <li>How to link to a route</li>
            <li>Further useful React Router features</li>
          </ul>
        </section>
        <section class="break-slide">
          <h1>Questions?</h1>
        </section>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/gh/Zuehlke/zuehlke-reveal-package@f42658c99dec0812d754d935263a70b93b81f54b/release/index.js"></script>
    <script>
      setupZuehlkeRevealPresentation();
    </script>
  </body>
</html>
