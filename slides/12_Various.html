<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>12 Various | Essential React</title>

    <link rel="icon" href="../img/zuehlke_logo.jpg">
    <link rel="stylesheet" href="../dist/reset.css">
    <link rel="stylesheet" href="../dist/reveal.css">
    <link rel="stylesheet" href="../css/theme/zuehlke.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="../plugin/highlight/monokai.css">
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section class="deck-slide">
            <h1>Essential React <br/>
                12 Various</h1>
        </section>
        <section>
            <h2>Content 1/2</h2>
            <ul>
                <li>Virtual DOM</li>
                <li>State Management</li>
                <li>Data Management</li>
                <li>Class Components</li>
                <li>i18n / Internationalization</li>
                <li>Virtualization</li>
                <li>Code-Splitting</li>
            </ul>
        </section>
        <section>
            <h2>Content 2/2</h2>
            <ul>
                <li>Further React Hooks</li>
                <li>Next.JS</li>
                <li>Refs</li>
                <li>browserslist</li>
                <li>ESLint configuration</li>
                <li>Error Boundaries</li>
            </ul>
        </section>
        <section>
            <section>
                <h2>Virtual DOM</h2>
                <img src="../img/virtual-dom.png" style="max-width: 70%"/>
                <a href="https://www.oreilly.com/library/view/learning-react-native/9781491929049/ch02.html" target="_blank"
                   rel="noopener noreferrer">https://www.oreilly.com/library/view/learning-react-native/9781491929049/ch02.html</a>
            </section>
            <section>
                <h3>Summary</h3>
                <p class="fragment">Replacing and rendering the whole real DOM is costly!</p>
                <p class="fragment">Virtual DOM is a representation of the actual DOM</p>
                <p class="fragment">Its purpose is to identify which parts of the real DOM need to be changed upon changes, by comparing the new virtual DOM result against the previous one.</p>
                <p class="fragment">The delta then gets applied on the real DOM.<br/>E.g. only one element gets updated within a long list instead of the whole list.</p>
            </section>
        </section>
        <section>
            <section>
                <h2>State Management</h2>
            </section>
            <section>
                <h2>Redux / Zustand (flux-based)</h2>
                <img src="../img/flux-simple.png" />
            </section>
            <section>
                <h2>Recoil / Jotai (atom-based)</h2>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    const textState = atom({
                    key: 'textState',
                    default: '',
                    });
                </script></code></pre></p>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    const [text, setText] = useRecoilState(textState);
                </script></code></pre></p>
            </section>
            <section>
                <h2>valtio (proxy-based)</h2>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    const state = proxy({ count: 0, text: 'hello' })
                </script></code></pre></p>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    const snap = useSnapshot(state)
                    return (
                    <div>
                        {snap.count}
                        <button onClick={() => ++state.count}>+1</button>
                      </div>
                    )
                </script></code></pre></p>
            </section>
        </section>
        <section>
            <section>
                <h2>Data Management</h2>
            </section>
            <section>
                <h2>Requirements</h2>
                <ul>
                    <li>Handle repetitive data loading states (pending, success, error)</li>
                    <li>Cache response</li>
                    <li>Invalidate response</li>
                    <li>Handle mutations</li>
                </ul>
            </section>
            <section>
                <h2>Libraries</h2>
                <ul>
                    <li>SWR</li>
                    <li>react-query</li>
                </ul>
            </section>
            <section>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    import useSWR from 'swr'

                    const fetcher = (...args) => fetch(...args).then(res => res.json())

                    const { data, error } = useSWR('/api/user', fetcher)

                    if (error) return <div>failed to load</div>
                    if (!data) return <div>loading...</div>
                    return <div>hello {data.name}!</div>
                </script></code></pre></p>
            </section>
        </section>
        <section>
            <section>
                <h2>Class Components</h2>
            </section>
            <section>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                class HelloWorld extends React.Component {
                  render() {
                    return (
                      <div>Hello World</div>
                    );
                  }
                }
                </script></code></pre></p>
            </section>
            <section>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                class HelloWorld extends React.Component {
                  constructor(props) {
                    super(props);
                    this.state = {date: new Date()};
                  }
                  componentDidMount() {
                    this.timerID = setInterval(
                      () => this.setState({ date: new Date() }),
                      1000
                    );
                  }
                  componentWillUnmount() {
                    clearInterval(this.timerID);
                  }
                  render() {
                    return (
                      <>
                        <h1>Hello World, it is:</h1>
                        <h2>{this.state.date.toLocaleTimeString()}</h2>
                      </>
                    );
                  }
                }
                </script></code></pre></p>
            </section>
            <section>
                <h3>Class components</h3>
                <ul>
                    <li>are another way to write a component</li>
                    <li>must implement a render-method</li>
                    <li>can be enriched with lifecycle methods</li>
                    <li>May not contain React hooks</li>
                    <li>Are rarely used since the existence of functional components</li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <h2>i18n / Internationalization</h2>
            </section>
            <section>
                <h3>Libraries</h3>
                <ul>
                    <li>
                        <a href="https://formatjs.io/" target="_blank" rel="noopener noreferrer">FormatJS (aka React-Intl)</a>
                    </li>
                    <li>
                        <a href="https://react.i18next.com/" target="_blank" rel="noopener noreferrer">react-i18next</a>
                    </li>
                    <li>...</li>
                </ul>
            </section>
            <section>
                <h2>FormatJS (aka React-Intl)</h2>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                ReactDOM.render(
                  <IntlProvider locale={usersLocale} messages={translationsForUsersLocale}>
                    <App />
                  </IntlProvider>,
                  document.getElementById('container')
                )
                </script></code></pre></p>
            </section>
            <section>
                <h2>FormatJS (aka React-Intl)</h2>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    const { formatMessage } = useIntl();
                    &hellip;
                    return (
                      <h1>{formatMessage({ id: 'myOptionalPersonallyDefinedKey', description: 'title' })}</h1>
                      <h2><FormattedMessage
                                id="myOptionalPersonallyDefinedKey"
                                defaultMessage="Today is {ts, date, ::yyyyMMdd}"
                                values={{ts: Date.now()}}
                      /></h2>
                    );
                </script></code></pre></p>
            </section>
            <section>
                <h2>FormatJS (aka React-Intl) - Support</h2>
                <ul>
                    <li>Singular, plural, zero, one, many translation forms</li>
                    <li>Number / date formatting</li>
                    <li>Hard-coded Keys as well as autogenerated ones</li>
                    <li>Pre-compilation for run-time performance</li>
                    <li>Built in as well as custom formatters for different translation tools</li>
                    <li>Stores keys and translated terms in JSON-Files</li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <h2>Virtualization</h2>
            </section>
            <section>
                <ul>
                    <li>Technique to render only elements that are currently visible</li>
                    <li>Reduces workload of the browser</li>
                </ul>
            </section>
            <section>
                <h2>react-window</h2>
            </section>
            <section>
                <h2>Advice</h2>
                <p>Use virtualization as a "last resort", usually there are other places which are easier to fix.</p>
            </section>
        </section>
        <section>
            <section>
                <h2>Code-Splitting</h2>
                <p>React Lazy / Suspense</p>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    import React, { Suspense } from 'react';

                    const OtherComponent = React.lazy(() => import('./OtherComponent'));

                    function MyComponent() {
                      return (
                        <Suspense fallback={<div>Loading...</div>}>
                          <OtherComponent />
                        </Suspense>
                        );
                    }

                </script></code></pre></p>
            </section>
        </section>
        <section>
            <section>
                <h2>Further React Hooks</h2>
                <ul>
                    <li>useMemo</li>
                    <li>useCallback</li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <h2>Next.JS</h2>
            </section>
            <section>
                <h3>The Framework for React</h3>
                <ul>
                    <li>Server Side Rendering</li>
                    <li>Search Engine Optimization</li>
                    <li>Code Splitting</li>
                </ul>
            </section>
        </section>
        <section>
            <section>
                <h2>Refs</h2>
                <p>Or: How to break out of virtual dom</p>
            </section>
            <section>
                <p>Refs permit to obtain a reference to a real dom element</p>
            </section>
            <section>
                <h2>Focus</h2>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    import { useRef, useEffect } from "react";

                    export default function MyComponent() {
                      const inputRef = useRef(null);
                      useEffect(() => {
                        inputRef.current.focus();
                      }, []);

                      return (
                        <input ref={inputRef} />
                      );
                    }

                </script></code></pre></p>
                <p>Automatically set focus on page load</p>
                <div class="fragment tip">
                    There are alternatives such as using autofocus on the input field.
                </div>
            </section>
            <section>
                <h2>How to forward ref?</h2>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    function CustomInput({ ref }) {
                      return <input ref={ref} />;
                    }
                </script></code></pre></p>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    <CustomInput ref={ref} />
                </script></code></pre></p>
                <p class="fragment">
                    <span class="warn">Does not work!</span> &ndash; ref is a special prop (the other one is key)
                </p>
            </section>
            <section>
                <h2>forwardRef!</h2>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    const CustomInput = forwardRef((props, ref) => {
                      return <input ref={ref} />;
                    });

                    CustomInput.displayName = "CustomInput";
                </script></code></pre></p>
                <p><pre data-id="code"><code class="hljs tsx" data-trim><script type="text/template">
                    <CustomInput ref={ref} />
                </script></code></pre></p>
            </section>
        </section>
        <section>
            <h2>browserslist</h2>
            <p>The browserslist configuration controls the outputted JavaScript so that the emitted code will be
                compatible with the browsers specified.</p>
            <p>Polyfills still need to be added manually!</p>
        </section>
        <section>
            <h2>ESLint configuration</h2>
            <p>Multiple configurations and plugins can be configured in the <span class="code">extends</span> field
                value.</p>
            <p>If multiple configurations or plugins specify contradicting values for the same rule, the latter will
                be applied.</p>
            <p>Rules can be overridden in the <span class="code">rules</span> field value.</p>
        </section>
        <section>
            <section>
            <h2>Error Boundaries</h2>
        </section>
        <section>
            <p><pre data-id="code"><code class="hljs tsx" data-trim data-line-numbers="1,7-11,14-17"><script type="text/template">
                class ErrorBoundary extends React.Component {
                  constructor(props) {
                    super(props);
                    this.state = { hasError: false };
                  }
                    
                  static getDerivedStateFromError(error) {
                    // Update state so the next render will show
                    // the fallback UI.
                    return { hasError: true };
                  }
                
                  render() {
                    if (this.state.hasError) {
                       // You can render any custom fallback UI
                      return <h1>Something went wrong.</h1>;
                    }
                    
                    return this.props.children; 
                  }
                }
  </script></code></pre></p>
</section>
<section>
    <p><pre data-id="code"><code class="hljs tsx" data-trim data-line-numbers="1,6-10"><script type="text/template">
        class ErrorBoundary extends React.Component {
          constructor(props) {
            super(props);
          }
            
          componentDidCatch(error, errorInfo) {
            // You can also log the error to
            // an error reporting service
            logErrorToMyService(error, errorInfo);
          }

          render() {
            return this.props.children; 
          }
        }
</script></code></pre></p>
</section>
<section>
    <p><pre data-id="code"><code class="hljs tsx" data-trim data-line-numbers=""><script type="text/template">
        function MyComponent() {
          return <ErrorBoundary>
            <MyWidget />
          </ErrorBoundary>;
        }
</script></code></pre></p>
</section>
        </section>
    </div>
</div>

<script src="../dist/reveal.js"></script>
<script src="../plugin/notes/notes.js"></script>
<script src="../plugin/markdown/markdown.js"></script>
<script src="../plugin/highlight/highlight.js"></script>
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
    });
</script>
</body>
</html>
