<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />

    <title>12 Various | Essential React</title>

    <link rel="icon" href="../img/zuehlke_logo.jpg" />
    <link rel="stylesheet" href="../dist/reset.css" />
    <link rel="stylesheet" href="../dist/reveal.css" />
    <link rel="stylesheet" href="../css/theme/zuehlke.css" />

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="../plugin/highlight/monokai.css" />
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section class="deck-slide">
          <h1>
            Essential React <br />
            12 Various
          </h1>
        </section>
        <section>
          <h2>Content 1/3</h2>
          <ul>
            <li>Virtual DOM</li>
            <li>i18n / Internationalization</li>
            <li>Virtualization</li>
            <li>Code-Splitting</li>
            <li>Further React Hooks</li>
            <li>Mock Service Worker (MSW)</li>
          </ul>
        </section>
        <section>
          <h2>Content 2/3</h2>
          <ul>
            <li>Next.js</li>
            <li>Refs</li>
            <li>browserslist</li>
            <li>Prettier</li>
            <li>ESLint configuration</li>
            <li>Class Components</li>
            <li>Error Boundaries</li>
          </ul>
        </section>
        <section>
          <h2>Content 3/3</h2>
          <ul>
            <li>Advanced Animation</li>
            <li>Concurrent Features</li>
            <li>React Server Components</li>
          </ul>
        </section>
        <section>
          <section>
            <h2>Virtual DOM</h2>
            <img src="../img/virtual-dom.png" style="max-width: 70%" />
            <a
              href="https://www.oreilly.com/library/view/learning-react-native/9781491929049/ch02.html"
              target="_blank"
              rel="noopener noreferrer"
              >https://www.oreilly.com/library/view/learning-react-native/9781491929049/ch02.html</a
            >
          </section>
          <section>
            <h3>Summary</h3>
            <p class="fragment">
              Replacing and rendering the whole real DOM is costly!
            </p>
            <p class="fragment">
              Virtual DOM is a representation of the actual DOM
            </p>
            <p class="fragment">
              Its purpose is to identify which parts of the real DOM need to be
              changed upon changes, by comparing the new virtual DOM result
              against the previous one.
            </p>
            <p class="fragment">
              The delta then gets applied on the real DOM.<br />E.g. only one
              element gets updated within a long list instead of the whole list.
            </p>
          </section>
        </section>
        <section>
          <section>
            <h2>i18n / Internationalization</h2>
          </section>
          <section>
            <h3>Libraries</h3>
            <ul>
              <li>
                <a
                  href="https://formatjs.io/"
                  target="_blank"
                  rel="noopener noreferrer"
                  >FormatJS (aka React-Intl)</a
                >
              </li>
              <li>
                <a
                  href="https://react.i18next.com/"
                  target="_blank"
                  rel="noopener noreferrer"
                  >react-i18next</a
                >
              </li>
              <li>...</li>
            </ul>
          </section>
          <section>
            <h2>FormatJS (aka React-Intl)</h2>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                ReactDOM.render(
                  <IntlProvider locale={usersLocale} messages={translationsForUsersLocale}>
                    <App />
                  </IntlProvider>,
                  document.getElementById('container')
                )
                </script></code></pre>
          </section>
          <section>
            <h2>FormatJS (aka React-Intl)</h2>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                    const { formatMessage } = useIntl();
                    …
                    return (
                      <h1>{formatMessage({ id: 'myOptionalPersonallyDefinedKey', description: 'title' })}</h1>
                      <h2><FormattedMessage
                                id="myOptionalPersonallyDefinedKey"
                                defaultMessage="Today is {ts, date, ::yyyyMMdd}"
                                values={{ts: Date.now()}}
                      /></h2>
                    );
                </script></code></pre>
          </section>
          <section>
            <h2>FormatJS (aka React-Intl) - Support</h2>
            <ul>
              <li>Singular, plural, zero, one, many translation forms</li>
              <li>Number / date formatting</li>
              <li>Hard-coded Keys as well as autogenerated ones</li>
              <li>Pre-compilation for run-time performance</li>
              <li>
                Built in as well as custom formatters for different translation
                tools
              </li>
              <li>Stores keys and translated terms in JSON-Files</li>
            </ul>
          </section>
        </section>
        <section>
          <section>
            <h2>Virtualization</h2>
          </section>
          <section>
            <ul>
              <li>
                Technique to render only elements that are currently visible
              </li>
              <li>Reduces workload of the browser</li>
            </ul>
          </section>
          <section>
            <h2>react-window</h2>
          </section>
          <section>
            <h2>Advice</h2>
            <p>
              Use virtualization as a "last resort", usually there are other
              places which are easier to fix.
            </p>
          </section>
        </section>
        <section>
          <section>
            <h2>Code-Splitting</h2>
            <p>React Lazy / Suspense</p>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                    import React, { Suspense } from 'react';

                    const OtherComponent = React.lazy(() => import('./OtherComponent'));

                    function MyComponent() {
                      return (
                        <Suspense fallback={<div>Loading...</div>}>
                          <OtherComponent />
                        </Suspense>
                        );
                    }

                </script></code></pre>
          </section>
        </section>
        <section>
          <section>
            <h2>Further React Hooks</h2>
            <ul>
              <li>useMemo</li>
              <li>useCallback</li>
              <li>useLayoutEffect</li>
              <li>useDeferredValue</li>
              <li>useTransition</li>
            </ul>
          </section>
        </section>
        <section>
          <section>
            <h2>Mock Service Worker (MSW)</h2>
          </section>

          <section>
            <p>
              <em
                >It is the closest thing to a mocking server without having to
                create one.</em
              ><br />
              <small
                >&mdash;
                <a href="https://mswjs.io/docs/"
                  >Mock Service Worker Docs</a
                ></small
              >
            </p>
          </section>

          <section>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                    npm install msw --save-dev
                </script></code></pre>
          </section>

          <section>
            <h3>How it works in the browser</h3>
            <p><img src="../img/mock_service_worker.jpeg" /></p>

            <p>
              <small
                >Source:
                <a href="https://mswjs.io/docs/"
                  >https://mswjs.io/docs/</a
                ></small
              >
            </p>
          </section>

          <section>
            <h3>How it works in Node</h3>

            <p>
              The <em>node-request-interceptor</em> library is used to intercept
              HTTP requests.
            </p>
          </section>

          <section>
            <h3>Advantages over conventional mocking approaches</h3>
            <ul>
              <li>
                No wrapper in the application code necessary &ndash; it can call
                the native fetch
              </li>
              <li>
                The mock is completely seamless &ndash; the application behaves
                the same with and without mocks
              </li>
            </ul>
          </section>

          <section>
            <p><span class="code">src/mocks/server.ts</span></p>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers=""><script type="text/template">
import { setupServer } from 'msw/node'
import { handlers } from './handlers'

// This configures a request mocking server
// with the given request handlers.
export const server = setupServer(...handlers);
    </script></code></pre>
          </section>

          <section>
            <p><span class="code">src/setupTests.ts</span></p>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers=""><script type="text/template">
import { server } from "./mocks/server.js";

// Establish API mocking before all tests.
beforeAll(() => server.listen());

// Reset any request handlers that we may add during
// the tests, so they don't affect other tests.
afterEach(() => server.resetHandlers());

// Clean up after the tests are finished.
afterAll(() => server.close());
    </script></code></pre>
          </section>

          <section>
            <p><span class="code">src/handlers.ts</span></p>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers=""><script type="text/template">

const handlers = [
  rest.get(
      "/api/v2/pokemon?limit=50",
      (_, res, ctx) => res(ctx.json({
        results: [
          { name: "Pikachu", url: "…" },
          …
        ]
      }))
  )
];

export default handlers;
    </script></code></pre>
          </section>
        </section>
        <section>
          <section>
            <h2>
              <a
                href="https://nextjs.org/docs"
                target="_blank"
                rel="noopener noreferrer"
                >Next.js</a
              >
            </h2>
          </section>
          <section>
            <h3>Rendering Techniques supported by Next.js</h3>
            <ul>
              <li>Client Side Rendering (CSR)</li>
              <li>Static Site Generation (SSG)</li>
              <li>Server Side Rendering (SSR)</li>
            </ul>
          </section>
          <section>
            <h3>The Framework for React</h3>
            <ul>
              <li>Search Engine Optimization (SEO)</li>
              <li>Code Splitting</li>
              <li>File-based Routing</li>
              <li>Built-in CSS Support</li>
              <li>Image, Font & Script Optimization</li>
              <li>Serverless Functions (API Routes)</li>
              <li>Middleware (Request Interceptors)</li>
            </ul>
          </section>
        </section>
        <section>
          <section>
            <h2>Refs</h2>
            <p>Or: How to break out of virtual dom</p>
          </section>
          <section>
            <p>Refs permit to obtain a reference to a real dom element</p>
          </section>
          <section>
            <h2>Focus</h2>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                    import { useRef, useEffect } from "react";

                    export default function MyComponent() {
                      const inputRef = useRef(null);
                      useEffect(() => {
                        inputRef.current.focus();
                      }, []);

                      return (
                        <input ref={inputRef} />
                      );
                    }

                </script></code></pre>
            <p>Automatically set focus on page load</p>
            <div class="fragment tip">
              There are alternatives such as using autofocus on the input field.
            </div>
          </section>
          <section>
            <h2>How to forward ref?</h2>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                    function CustomInput({ ref }) {
                      return <input ref={ref} />;
                    }
                </script></code></pre>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                    <CustomInput ref={ref} />
                </script></code></pre>
            <p class="fragment">
              <span class="warn">Does not work!</span> &ndash; ref is a special
              prop (the other one is key)
            </p>
          </section>
          <section>
            <h2>forwardRef!</h2>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                    const CustomInput = forwardRef((props, ref) => {
                      return <input ref={ref} />;
                    });

                    CustomInput.displayName = "CustomInput";
                </script></code></pre>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                    <CustomInput ref={ref} />
                </script></code></pre>
          </section>
        </section>
        <section>
          <h2>browserslist</h2>
          <p>
            The browserslist configuration controls the outputted JavaScript so
            that the emitted code will be compatible with the browsers
            specified.
          </p>
          <p>Polyfills still need to be added manually!</p>
        </section>
        <section>
          <h2>Tools</h2>
          <ul>
            <li>Prettier</li>
            <li>ESLint</li>
            <li>React Developer Tools</li>
          </ul>
        </section>
        <section>
          <section>
            <h2>Prettier</h2>
            <p>
              Your code is always consistent, as is the code from the rest of
              your team. No more bikeshedding!
            </p>
            <p>
              <a
                href="https://prettier.io/playground/"
                target="_blank"
                rel="noopener noreferrer"
              >
                See it in action
              </a>
            </p>
          </section>
          <section>
            <p>
              Let's install it either locally
              <span class="code">npm i -D prettier</span> or run it with
              <span class="code">npx prettier</span>.
            </p>
            <p>
              Add the plugin for your IDE
              <a
                href="https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode"
                target="_blank"
                rel="noopener noreferrer"
                >VS Code</a
              >,
              <a
                href="https://plugins.jetbrains.com/plugin/10456-prettier"
                target="_blank"
                rel="noopener noreferrer"
                >JetBrains</a
              >, etc.
            </p>
          </section>
          <section>
            <p>
              Prettier is heavily opinionated. Luckily there are a lot of
              <a
                href="https://prettier.io/docs/en/options.html"
                target="_blank"
                rel="noopener noreferrer"
              >
                options
              </a>
              to customize it to your liking.
            </p>
            <p>
              Add a <span class="code">.prettierrc.js</span> file to your
              project:
            </p>
            <pre>
                    <code class="hljs javascript" data-trim data-noescape>
                        module.exports = {
                            endOfLine: 'lf',
                            singleQuote: true,
                            trailingComma: 'all',
                            quoteProps: 'consistent',
                        }
                    </code>
                </pre>
          </section>
          <section>
            <p>
              Add an npm script to the <span class="code">package.json</span>:
            </p>
            <pre>
                    <code class="hljs javascript" data-trim data-noescape>
                        "scripts": {
                            "pretty": "prettier --write \"src/**/*.{js,json,
                                yml,yaml,css,scss,ts,tsx,md}\"",
                        },
                    </code>
                </pre>
          </section>
        </section>
        <section>
          <h2>ESLint configuration</h2>
          <p>
            Multiple configurations and plugins can be configured in the
            <span class="code">extends</span> field value.
          </p>
          <p>
            If multiple configurations or plugins specify contradicting values
            for the same rule, the latter will be applied.
          </p>
          <p>
            Rules can be overridden in the <span class="code">rules</span> field
            value.
          </p>
        </section>
        <section>
          <section>
            <h2>Class Components</h2>
          </section>
          <section>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                class HelloWorld extends React.Component {
                  render() {
                    return (
                      <div>Hello World</div>
                    );
                  }
                }
                </script></code></pre>
          </section>
          <section>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim><script type="text/template">
                class HelloWorld extends React.Component {
                  constructor(props) {
                    super(props);
                    this.state = {date: new Date()};
                  }
                  componentDidMount() {
                    this.timerID = setInterval(
                      () => this.setState({ date: new Date() }),
                      1000
                    );
                  }
                  componentWillUnmount() {
                    clearInterval(this.timerID);
                  }
                  render() {
                    return (
                      <>
                        <h1>Hello World, it is:</h1>
                        <h2>{this.state.date.toLocaleTimeString()}</h2>
                      </>
                    );
                  }
                }
                </script></code></pre>
          </section>
          <section>
            <h3>Class components</h3>
            <ul>
              <li>are another way to write a component</li>
              <li>must implement a render-method</li>
              <li>can be enriched with lifecycle methods</li>
              <li>May not contain React hooks</li>
              <li>
                Are rarely used since the existence of functional components
              </li>
            </ul>
          </section>
        </section>
        <section>
          <section>
            <h2>Error Boundaries</h2>
          </section>
          <section>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers=""><script type="text/template">
                    function MyComponent() {
                    return <ErrorBoundary>
                        <MyWidget />
                    </ErrorBoundary>;
                    }
            </script></code></pre>
          </section>
          <section>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="1,7-11,14-17"><script type="text/template">
                    class ErrorBoundary extends React.Component {
                    constructor(props) {
                        super(props);
                        this.state = { hasError: false };
                    }
                        
                    static getDerivedStateFromError(error) {
                        // Update state so the next render will show
                        // the fallback UI.
                        return { hasError: true };
                    }
                    
                    render() {
                        if (this.state.hasError) {
                        // You can render any custom fallback UI
                        return <h1>Something went wrong.</h1>;
                        }
                        
                        return this.props.children; 
                    }
                    }
            </script></code></pre>
          </section>
          <section>
            <pre
              data-id="code"
            ><code class="hljs tsx" data-trim data-line-numbers="1,6-10"><script type="text/template">
                    class ErrorBoundary extends React.Component {
                    constructor(props) {
                        super(props);
                    }
                        
                    componentDidCatch(error, errorInfo) {
                        // You can also log the error to
                        // an error reporting service
                        logErrorToMyService(error, errorInfo);
                    }

                    render() {
                        return this.props.children; 
                    }
                    }
            </script></code></pre>
          </section>
        </section>
        <section>
          <h2>Advanced Animation</h2>
          <p>
            One option:
            <a
              href="https://www.framer.com/motion/"
              target="_blank"
              rel="noopener noreferrer"
              >framer-motion</a
            >
          </p>
          <p>
            <a
              href="https://codesandbox.io/s/framer-motion-side-menu-mx2rw?from-embed=&file=/src/Example.tsx"
              target="_blank"
              rel="noopener noreferrer"
              >framer-motion Demo</a
            >
          </p>
        </section>
        <section>
          <section data-auto-animate>
            <h2>Concurrent Features</h2>
          </section>
          <section data-auto-animate>
            <h2>Concurrent Features</h2>
            <ul>
              <li>New with React 18</li>
              <li>
                Allows React to prepare a part of the UI in the background
              </li>
              <li>Will mostly be used via libraries (in development)</li>
            </ul>
          </section>
          <section>
            <ul>
              <li data-id="suspense">
                <a
                  href="https://17.reactjs.org/docs/concurrent-mode-suspense.html#approach-3-render-as-you-fetch-using-suspense"
                  >Suspense for data fetching</a
                >
              </li>
              <li>startTransition/useTransition</li>
              <li>useDeferredValue</li>
            </ul>
          </section>
        </section>
        <section>
          <section data-auto-animate>
            <h2>React Server Components (RSC)</h2>
          </section>
          <section data-auto-animate>
            <h2>React Server Components (RSC)</h2>
            <ul>
              <li>Still in development</li>
              <li>Different from server-side rendering</li>
              <li>Server components are never rendered on the client</li>
            </ul>
            <p>&rarr;Eliminates roundtrips, reduces bundle size</p>
          </section>
        </section>
      </div>
    </div>

    <script src="../dist/reveal.js"></script>
    <script src="../plugin/notes/notes.js"></script>
    <script src="../plugin/markdown/markdown.js"></script>
    <script src="../plugin/highlight/highlight.js"></script>
    <script>
      // More info about initialization & config:
      // - https://revealjs.com/initialization/
      // - https://revealjs.com/config/
      Reveal.initialize({
        hash: true,

        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes],
      });
    </script>
  </body>
</html>
